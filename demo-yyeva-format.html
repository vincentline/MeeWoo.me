<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ€æœ¯è°ƒç ” - YYEVA åŒé€šé“è§†é¢‘æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            margin-bottom: 20px;
            color: #333;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #fafafa;
            border-radius: 4px;
        }
        
        .section h2 {
            margin-bottom: 15px;
            font-size: 18px;
            color: #555;
        }
        
        .canvas-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .canvas-item {
            text-align: center;
        }
        
        .canvas-item p {
            margin-bottom: 10px;
            font-weight: bold;
            color: #666;
        }
        
        canvas {
            border: 2px solid #ddd;
            display: block;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMiIgY3k9IjIiIHI9IjEiIGZpbGw9IiNlM2UzZTMiLz48L3N2Zz4=');
            background-repeat: repeat;
            background-size: 8px 8px;
        }
        
        button {
            background: #409eff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        button:hover {
            background: #66b1ff;
        }
        
        .info {
            background: #ecf5ff;
            border-left: 4px solid #409eff;
            padding: 12px 16px;
            margin: 15px 0;
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }
        
        .code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin-top: 10px;
        }
        
        video {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ æŠ€æœ¯è°ƒç ”ï¼šYYEVA åŒé€šé“è§†é¢‘è§£æ</h1>
        
        <div class="section">
            <h2>ä»€ä¹ˆæ˜¯ YYEVA æ ¼å¼ï¼Ÿ</h2>
            <div class="info">
                <strong>YYEVA (YY Effect Video Animation)</strong> æ˜¯ä¸€ç§æ”¯æŒé€æ˜é€šé“çš„ MP4 è§†é¢‘æ ¼å¼ã€‚<br>
                <br>
                <strong>æ ¸å¿ƒåŸç†ï¼š</strong><br>
                â€¢ å°†å½©è‰²è§†é¢‘å’Œ Alpha é€šé“åˆå¹¶åˆ°ä¸€ä¸ª MP4 æ–‡ä»¶ä¸­<br>
                â€¢ é€šå¸¸é‡‡ç”¨å·¦å³å¹¶æ’æˆ–ä¸Šä¸‹å¹¶æ’çš„å¸ƒå±€<br>
                â€¢ å·¦ä¾§ï¼ˆæˆ–ä¸Šæ–¹ï¼‰ï¼šå½©è‰²ç”»é¢<br>
                â€¢ å³ä¾§ï¼ˆæˆ–ä¸‹æ–¹ï¼‰ï¼šAlpha é€šé“ï¼ˆé»‘ç™½é®ç½©ï¼‰<br>
                <br>
                <strong>ä¼˜åŠ¿ï¼š</strong><br>
                â€¢ å…¼å®¹æ€§å¥½ï¼ˆæ‰€æœ‰æ”¯æŒ MP4 çš„æ’­æ”¾å™¨éƒ½èƒ½åŠ è½½ï¼‰<br>
                â€¢ æ–‡ä»¶å¤§å°è¾ƒå°ï¼ˆç›¸æ¯” PNG åºåˆ—å¸§ï¼‰<br>
                â€¢ æ”¯æŒç¡¬ä»¶åŠ é€Ÿè§£ç 
            </div>
        </div>
        
        <div class="section">
            <h2>1. æ¨¡æ‹ŸåŒé€šé“è§†é¢‘</h2>
            <div class="info">
                è¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸ª YYEVA æ ¼å¼çš„è§†é¢‘ç»“æ„ï¼ˆå·¦å½©è‰² + å³Alphaï¼‰
            </div>
            <div class="canvas-group">
                <div class="canvas-item">
                    <p>æºè§†é¢‘ï¼ˆåŒé€šé“ï¼‰</p>
                    <canvas id="sourceCanvas" width="400" height="200"></canvas>
                </div>
            </div>
            <button onclick="drawMockVideo()">ç»˜åˆ¶æ¨¡æ‹Ÿè§†é¢‘</button>
        </div>
        
        <div class="section">
            <h2>2. é€šé“åˆ†ç¦»</h2>
            <div class="info">
                å°†åŒé€šé“è§†é¢‘åˆ†ç¦»æˆå½©è‰²é€šé“å’Œ Alpha é€šé“
            </div>
            <div class="canvas-group">
                <div class="canvas-item">
                    <p>å½©è‰²é€šé“</p>
                    <canvas id="colorCanvas" width="200" height="200"></canvas>
                </div>
                <div class="canvas-item">
                    <p>Alpha é€šé“</p>
                    <canvas id="alphaCanvas" width="200" height="200"></canvas>
                </div>
            </div>
            <button onclick="separateChannels()">åˆ†ç¦»é€šé“</button>
        </div>
        
        <div class="section">
            <h2>3. åˆæˆæœ€ç»ˆæ•ˆæœ</h2>
            <div class="info">
                å°†å½©è‰²é€šé“ + Alpha é€šé“åˆæˆä¸ºå¸¦é€æ˜çš„æœ€ç»ˆç”»é¢
            </div>
            <div class="canvas-group">
                <div class="canvas-item">
                    <p>åˆæˆç»“æœï¼ˆå¸¦é€æ˜ï¼‰</p>
                    <canvas id="resultCanvas" width="200" height="200"></canvas>
                </div>
            </div>
            <button onclick="compositeChannels()">åˆæˆç”»é¢</button>
        </div>
        
        <div class="section">
            <h2>4. æ ¸å¿ƒä»£ç ç¤ºä¾‹</h2>
            <div class="code">
// 1. ä»è§†é¢‘å…ƒç´ ä¸­æå–å¸§æ•°æ®
const video = document.getElementById('yeevaVideo');
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');

canvas.width = video.videoWidth;
canvas.height = video.videoHeight;
ctx.drawImage(video, 0, 0);

const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

// 2. åˆ†ç¦»å·¦å³é€šé“ï¼ˆå‡è®¾å·¦å³å¹¶æ’ï¼‰
const halfWidth = canvas.width / 2;
const colorData = ctx.getImageData(0, 0, halfWidth, canvas.height);
const alphaData = ctx.getImageData(halfWidth, 0, halfWidth, canvas.height);

// 3. åˆæˆæœ€ç»ˆå›¾åƒ
const finalCanvas = document.createElement('canvas');
const finalCtx = finalCanvas.getContext('2d');
finalCanvas.width = halfWidth;
finalCanvas.height = canvas.height;

finalCtx.putImageData(colorData, 0, 0);

// åº”ç”¨ Alpha é€šé“
const finalImageData = finalCtx.getImageData(0, 0, halfWidth, canvas.height);
for (let i = 0; i < finalImageData.data.length; i += 4) {
    const alphaIndex = i;
    finalImageData.data[i + 3] = alphaData.data[alphaIndex]; // R é€šé“ä½œä¸º Alpha
}

finalCtx.putImageData(finalImageData, 0, 0);
            </div>
        </div>
        
        <div class="section">
            <h2>5. æŠ€æœ¯è¦ç‚¹æ€»ç»“</h2>
            <ul style="line-height: 2; color: #666; margin-left: 20px;">
                <li>âœ… ä½¿ç”¨ &lt;video&gt; å…ƒç´ åŠ è½½ MP4 æ–‡ä»¶</li>
                <li>âœ… é€šè¿‡ Canvas çš„ drawImage() æå–æ¯å¸§æ•°æ®</li>
                <li>âœ… ä½¿ç”¨ getImageData() åˆ†ç¦»å·¦å³ï¼ˆæˆ–ä¸Šä¸‹ï¼‰é€šé“</li>
                <li>âœ… å°† Alpha é€šé“çš„ R å€¼ä½œä¸ºé€æ˜åº¦åº”ç”¨åˆ°å½©è‰²é€šé“</li>
                <li>âœ… ä½¿ç”¨ requestAnimationFrame åŒæ­¥æ’­æ”¾</li>
                <li>âš ï¸ éœ€è¦å¤„ç†è§†é¢‘çš„æ’­æ”¾/æš‚åœ/è¿›åº¦æ§åˆ¶</li>
                <li>âš ï¸ å¤§åˆ†è¾¨ç‡è§†é¢‘å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜</li>
            </ul>
        </div>
    </div>

    <script>
        // ç»˜åˆ¶æ¨¡æ‹Ÿçš„åŒé€šé“è§†é¢‘
        function drawMockVideo() {
            const canvas = document.getElementById('sourceCanvas');
            const ctx = canvas.getContext('2d');
            
            const width = canvas.width;
            const height = canvas.height;
            const halfWidth = width / 2;
            
            // å·¦ä¾§ï¼šå½©è‰²æ¸å˜åœ†
            ctx.fillStyle = '#fcfcfc';
            ctx.fillRect(0, 0, halfWidth, height);
            
            const gradient = ctx.createRadialGradient(
                halfWidth / 2, height / 2, 20,
                halfWidth / 2, height / 2, 80
            );
            gradient.addColorStop(0, '#409eff');
            gradient.addColorStop(0.5, '#66b1ff');
            gradient.addColorStop(1, '#a0cfff');
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(halfWidth / 2, height / 2, 80, 0, Math.PI * 2);
            ctx.fill();
            
            // å³ä¾§ï¼šAlpha é€šé“ï¼ˆé»‘ç™½é®ç½©ï¼‰
            ctx.fillStyle = '#000000';
            ctx.fillRect(halfWidth, 0, halfWidth, height);
            
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(halfWidth + halfWidth / 2, height / 2, 80, 0, Math.PI * 2);
            ctx.fill();
            
            // æ·»åŠ åˆ†éš”çº¿
            ctx.strokeStyle = '#ff0000';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(halfWidth, 0);
            ctx.lineTo(halfWidth, height);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // æ·»åŠ æ ‡ç­¾
            ctx.font = 'bold 16px sans-serif';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('å½©è‰²é€šé“', halfWidth / 2, 20);
            ctx.fillText('Alpha é€šé“', halfWidth + halfWidth / 2, 20);
        }
        
        // åˆ†ç¦»é€šé“
        function separateChannels() {
            const sourceCanvas = document.getElementById('sourceCanvas');
            const colorCanvas = document.getElementById('colorCanvas');
            const alphaCanvas = document.getElementById('alphaCanvas');
            
            const sourceCtx = sourceCanvas.getContext('2d');
            const colorCtx = colorCanvas.getContext('2d');
            const alphaCtx = alphaCanvas.getContext('2d');
            
            const halfWidth = sourceCanvas.width / 2;
            const height = sourceCanvas.height;
            
            // æå–å·¦ä¾§å½©è‰²é€šé“
            const colorData = sourceCtx.getImageData(0, 0, halfWidth, height);
            colorCanvas.width = halfWidth;
            colorCanvas.height = height;
            colorCtx.putImageData(colorData, 0, 0);
            
            // æå–å³ä¾§ Alpha é€šé“
            const alphaData = sourceCtx.getImageData(halfWidth, 0, halfWidth, height);
            alphaCanvas.width = halfWidth;
            alphaCanvas.height = height;
            alphaCtx.putImageData(alphaData, 0, 0);
        }
        
        // åˆæˆé€šé“
        function compositeChannels() {
            const colorCanvas = document.getElementById('colorCanvas');
            const alphaCanvas = document.getElementById('alphaCanvas');
            const resultCanvas = document.getElementById('resultCanvas');
            
            const colorCtx = colorCanvas.getContext('2d');
            const alphaCtx = alphaCanvas.getContext('2d');
            const resultCtx = resultCanvas.getContext('2d');
            
            const width = colorCanvas.width;
            const height = colorCanvas.height;
            
            resultCanvas.width = width;
            resultCanvas.height = height;
            
            // è·å–æ•°æ®
            const colorData = colorCtx.getImageData(0, 0, width, height);
            const alphaData = alphaCtx.getImageData(0, 0, width, height);
            
            // åˆæˆ
            const resultData = colorData;
            for (let i = 0; i < resultData.data.length; i += 4) {
                // ä½¿ç”¨ Alpha é€šé“çš„ R å€¼ä½œä¸ºé€æ˜åº¦
                resultData.data[i + 3] = alphaData.data[i]; // R ä½œä¸º Alpha
            }
            
            resultCtx.putImageData(resultData, 0, 0);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨ç»˜åˆ¶
        window.onload = function() {
            drawMockVideo();
        };
    </script>
</body>
</html>
