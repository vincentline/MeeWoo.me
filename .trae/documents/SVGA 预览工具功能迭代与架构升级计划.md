# 项目功能迭代与架构升级计划文档

基于对现有代码库的深度分析及用户需求的梳理，本项目（SVGA/Lottie/MP4 预览与转换工具）的后续开发计划如下。

## 📅 阶段规划概览

### 第二阶段：核心编辑能力强化 (P1 - Core Features)

**目标**：完善 SVGA 和视频的基础编辑能力，从“预览”向“编辑”转型。

1. **SVGA 素材编辑增强 (需求 7 & 8) **

   * **功能**：

     * 素材（底图/文案）旋转支持。

   * **技术实现**：修改 `MaterialEditor` 组件，在 Canvas 绘制逻辑中引入 `ctx.rotate()` 和对齐计算。
2. **视频尺寸裁切 (需求 3)ing**

   * **功能**：允许用户自定义输出视频的宽高，支持居中裁切。

   * **技术实现**：在 `ffmpeg-service.js` 的转码滤镜中添加 `crop` 参数，前端增加裁切交互 UI。
3. **移动端兼容 (需求 12)**

   * **功能**：确保在手机浏览器上能正常播放和进行基础转换。

   * **技术实现**：优化 Viewport 设置，调整移动端下的按钮尺寸和布局，禁用不兼容的高级交互。

### 第三阶段：高级多媒体处理 (P2 - Advanced)

**目标**：利用 Web 技术实现桌面级的媒体处理能力。

1. **视频编辑模式，编辑支持旋转、缩放、位移、绿幕抠图、拆切画面、多段变速、剪裁视频时间...（编辑信息怎么保存，）**

* **功能**：在导出SVGA、MP4、双通道MP4，模式下支持调整整体音量，增加或减少。实时预览，播放音量和调整音量是同步的（0%-200%）。

* **技术实现**：用ffmpeg实现音频音量控制，先不做复杂音量，只做整体音量调节（0%-200%）。

1. **支持音量调整**

   * **功能**：在导出SVGA、MP4、双通道MP4，模式下支持调整整体音量，增加或减少。实时预览，播放音量和调整音量是同步的（0%-200%）。

   * **技术实现**：用ffmpeg实现音频音量控制，先不做复杂音量，只做整体音量调节（0%-200%）。

2. **WebP 全面支持 (需求 13)**

   * **功能**：支持 WebP 格式的导入预览及导出。

   * **技术实现**：利用 FFmpeg 的 `libwebp` 编码器，扩展 `ffmpeg-service.js` 的格式支持。

3. **智能变速 (需求 6)**

   * **功能**：支持视频时长延长（补帧/慢放），最大增加原始时长的 20%。

   * **技术实现**：修改 `ffmpeg-service.js` 中的 `setpts` 滤镜逻辑，计算精确的时间戳映射。

4. **双通道多段变速 (需求 5)**

   * **功能**：在双通道模式下支持分段变速。

   * **技术实现**：复用上述变速逻辑，应用于 Alpha 和 RGB 两个通道。

## ⚠️ 待定的

1. 右侧边栏，距离右边32px。右侧边弹窗可拖拽，因为可以不影响编辑时候遮挡。
2. 变速弹窗时长显示改为：

   1. 上面显示：4.00s/4.00s
   2. 下面显示：变速后时长/原视频时长
3. 播放器上外边左对齐的文字，后面加上显示尺寸“/ 750×1096”
4. 底部浮层，原模式名改对齐到底部浮层左边，宽度适应内容，最大宽度100%；默认只显示a，hover后显示b：

   1. 模式名 / 文件名 >
   2. 模式名 / 文件名称：文件名 文件大小：100KB ... <
   3. 播放进度，时间，用格式：3.12s/4s
5. 更换背景色hover颜色出现竖的颜色菜单。
6. 调音量用hover静音按钮出现竖的音量滑块。

***

